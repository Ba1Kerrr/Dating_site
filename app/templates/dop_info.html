<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{{ url_for('static', path='./static/user.css') }}" rel="stylesheet">
</head>
<body>
    <div class = "container">
        <h1>Hello,{{user}}</h1>
        <div class="content">
                <form method="post" id="form" action="/users/{{user}}" enctype="multipart/form-data">
                    <div class="user-details">
                                <div class="input-box">
                            <span class="details">Age</span>
                            <input type="text" name="age" value = "777" placeholder="Enter your Age">
                        </div>
                        <div class="input-box">
                            <span class="details">Gender</span>
                            <select id="gender" name="gender" >
                                <option value="Male">Male</option>
                                <option value="Femail">Femail</option>
                            </select>
                        </div>

                        <div class="input-box">
                            <span class="details">Name</span>
                            <input type="text" name="name" value = 'Мухаммед' placeholder="Enter your Name" >
                        </div>
                        <div class="input-box">
                            <span class="details">Location</span>
                            <input type="text" name="location" value = 'xdland' placeholder="Enter your location" >
                        </div>
                        <div class="input-box">
                            <script type="text/javascript">
                                function previewFile() {
                                    const preview = document.querySelector('img'); 
                                    const file = document.querySelector('input[type=file]').files[0];
                                    const reader = new FileReader();
                                    reader.addEventListener("load", function() {
                                        preview.src = reader.result; // show image in <img> tag
                                        uploadFile(file)
                                    }, false);
                                    if (file) {
                                        reader.readAsDataURL(file);
                                    }
                                }
                            
                                function uploadFile(file) {
                                    var formData = new FormData();
                                    formData.append('file', file);
                                    fetch('/upload', {
                                            method: 'POST',
                                            body: formData,
                                        })
                                        .then(response => {
                                            console.log(response);
                                        })
                                        .catch(error => {
                                            console.error(error);
                                        });
                                }
                            </script>
                            <input type="file" onchange="previewFile()" name = "file"><br>
                            <img src="" height="200" alt="Image preview...">
                            <input type="reset" onclick="document.getElementById('form').reset();document.querySelector('img').src = '';" value="Reset">
                         <!-- Notes

                        The code does not include error handling for cases where the file cannot be read or uploaded.
                        Additionally, the following points should also be considered:
                        
                        Error handling when submitting the form, for example, if the file is too large or has an incorrect format.
                        Error handling when reading the file, for example, if the file is corrupted or cannot be read.
                        Ensuring security when sending the file, for example, checking the file type and its contents to prevent sending malicious files. -->
                        </div>
                    </div>
                    <div class="button-container">
                        <div class="button">
                            <input type="submit" value="Register">
                        </div>
                    </div>
                </form>
                
        </div>
    </div>
</body>
</html>